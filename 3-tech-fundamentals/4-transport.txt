Layer 4 - Transport
-------------------

Adds 2 new protocols: 
- TCP (Transmission Control Protocol)
- UDP (User Data Protocol)

TCP is picked for reliability & error correction. Usually for HTTP
Creates a bidirectional channel

UDP is faster but less reliable

TCP transfers data using Segments and are encapsulated within IP packets

Segments breakdown (TCP header):
- Source port
- Destination port
- Sequence number: used for error correction and ordering of IP packets
- Acknowledgment: a way to show that the segment was received by the destination
- Flags 'n' things: used to close connections and other options
- TCP window: number of bytes willing to receive after acknowledgment
- Checksum: used for error checking
- Urgent pointer: used to control traffic

Architecture of TCP: a connection based protocol that allows communication between a client and a server
The use of segments allows for the ordered transfer of data

Ephemeral port: the port that the client picks - usually a high number
Well known port: 443, 80, etc

TCP connection 3 way handshake:
- client informs server with sequence number it's going to start with using a sequence. Sets SYN
- server creates its own segment with its own segment number and responds with SYN & ACK and increments the client's sequence number
- client acknowledges the server by responding with an ACK containing the incremented server sequence number and its own incremented sequence number


Stateless firewall (NACL): 
- Outbound segments: client to server
- Inbound segments: server to client

Stateful firewall (security groups): if you allow the outbound, the inbound is automatically allowed